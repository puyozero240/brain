# 『PythonでつくるWebアプリの作り方』の学習メモ(1)


私はAppSheetというGoogleが出しているノーコードツールで業務アプリを作っている。

ノーコードツールを作るにあたり、業務内で扱われるデータの流れというものを定義する必要があり、一般的にデータモデリングと言われている。

ノーコードツールでもデータモデリングをしっかりすることで将来的に使えるデータをためていこうという「読み書きパソコン」というYouTubeチャンネルの方向性で私は学習を進めている。

[読み書きパソコン](https://www.youtube.com/@yomikakiPC)

さらにその知見を使ってノーコードではなくしっかりコードを書いてアプリを作ろうと現在Pythonを学習中だ。

これらの記事はその学習の中でのログを学習ノートとして残しておこうという趣旨で書かれている。

[【学習メモ】PythonでつくるWebアプリの作り方｜ぷよぜろ｜note](https://note.com/puyozero/m/m961b392421a8)

現在使っている学習教材は下記の書籍。

https://x.gd/qRHpC

参考になる情報は少ないと思うが、ガチンコエンジニアの皆様は「この人は個々で躓いてるんだなぁ」と眺めてもらえると嬉しい。
アドバイスなどいただけるとなお嬉しい。

---

## POSTの項で投稿したらトップページに飛ぶんだけどエラーが出る

- 書籍通りにコーディングし、サイトを立ち上げるところまでは無事にできた。
- しかしフォームに入力舌内容を送信ボタンを押して送信すると下記のエラーが出てくる。
    
    > **Not Found**
    
    > The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.
    > 
- 日本語にしてみるとどうやら「そのURLはないよ」という意味のようだ。
    
    ### `app.py` のリンクの部分が間違っている？
    
    ```python
    if contents:
                message_list.insert(0, Message(id , user_name, contents))
            return render_template(
                "top.html", login_user_name = login_user_name, message_list=message_list
            )
    ```
    
    - `message_list.insert(0, Message(id , user_name, contents))` の最後の `contents` の綴りが間違っていたので修正
    - `top.html` の部分が `top_html` となっていたので修正

### この修正でも同様のエラーが出る。

- となると怪しいのは `write.html`
    - ここでもタイポがあるのかもしれない。
- …そう思って調べてみたがよくわからない。

### わからんのでAI（Gemini）に聞いた。

```
（フォルダをアップロードして）

Not Found
The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.

上記エラーが出る。
原因がわからないので教えてほしい。
答えを教えるのではなく、答えに導くためのアドバイスをしてほしい。
```

- 以下回答
    
    ```
    フォームの送信先:
    もしフォームの送信（書き込みボタンや検索ボタンのクリック）時にエラーが出る場合、そのフォームが どのURL に どのメソッド（GET または POST）でデータを送信しようとしているかを確認してみてください。
    フォームの定義はHTMLファイル（top.html や write.html）の <form> タグに書かれています。
    ```
    
- この返事を見て `write.html` を確認してみたところタイポを発見。
    
    ```python
    <form action="{{url_for('write')}} method="POST">
        <p><textarea name="contents" rows="5" cols="60"></textarea></p>
        <input type="hidden" name="user_name" value="{{login_user_name}}"></label>
        <input type="submit" value="書き込み">
    </form>
    ```
    
    - `<form action="{{url_for('write')}} method="POST">` の部分だ。
    `{{url_for('write')}}>` の部分をダブルクオーテーションで閉じてない。
    多分これだろう。

### 解決！！！

- 無事に書き込まれた。
- 結構初歩的でワロタ

## 学習のアウトプット

### formタグのactinonは、入力内容をどこに送るかを指定するためにある

- そもそも `.html` の `action=xxx` ってなんだろうと疑問を持った
- Gemini先生曰く
    - フォームに入力されたデータをどこに送るのかを指定するためにある
    - 送信ボタンが押されたときに送信するURLを指定する
- だそう。
- `form action="URL"` で指定するようだ
    - このurlはjinja2とかのテンプレURLと置き換えることができるよう

### `post`と `get` は送信するデータの機密性によって使い分ける

- そもそも `post` と `get` の違いってなんだっけ？とも思う。
- 調べてみると
    - **両方ともデータを送るという役割**を持っているということは共通
    - それぞれで送り方が違う
- ということがわかった。
- 簡単な使い分け方を残しておこう
    - `post`
        - `post`はより機密性のある情報を送るときに使われる
            - idとかパスワードとかのことだ
        - ブラウザを更新したときに「フォームを再送信しますか？」というやつが出てくる場合は `post`になっている
            - めっちゃ心当たりありまくり☆マクリスティ
    - `get`
        - urlに入力した内容が表示される
            - Googleの検索結果とかがそうだ
        - つまり
            - URLを誰かに共有したい
            - URLをブックマークしたい
        - といったときには `get` じゃないとできないということ

### `get` は情報を取得（get）するための情報（条件）を送信している

- 私はてっきり `get` がサーバーから情報を取ってくるもので、 `post` が情報送るものだと思っていた。
    - 「Xでも投稿するとき『ポストする』って言うじゃん！！！」
    - そういう単純な見解だった。
    ユーザー側の視点だとこういうふうになる。
    - しかし実際には違う。
- いったい誰視点からみた `post` と `get` なのだろうか…Gemini先生に聞いてみた

> どちらも「クライアント（ブラウザ）」が「サーバー」に対して行うリクエストの種類

GET = 情報を**取得したい**
POST = **情報を送信（登録・更新）したい**
> 
- ふむ、感覚的にはあっている、と。
- つまりデータベース的に置き換えていうと
    - GET = READ
    - POST = CREATE, UPDATE

> GETの根本的な意味は、「（サーバーから）情報を**ください** (Get)」です。
> 
> - **ユーザーの感覚：「情報を取得し表示する」**
>     - これは**大正解**です。それがGETの最終目的です。
> - **なぜ情報を送るのか？**
>     - ただ「情報をください」だけでは、サーバーは「**何の**情報が欲しいの？」と困ってしまいます。
>     - そこで、クライアント（ブラウザ）は「**こういう条件の**情報をください」と、**条件**をサーバーに伝える必要があります。
>     - この「**条件**」こそが、ユーザーさんが「送信している」と感じる情報です。
- ってことはそれぞれ**最終目的を端的に言っている**っていうことか
    - ブラウザが情報を取得（get）する
        1. 「〇〇って情報をください」を達成するために、「〇〇」という情報をURLのにくっつけてサーバーに送る
        `google.com/search?q=〇〇` 
        2. サーバーから情報が返ってきて情報が取得できる（get）
        - 1. の部分しか私は見てなかったわけだ。
        その情報を使ってサーバーから情報を取得（get）するってことか
    - ブラウザが情報を送る（post）
        - 入力されたデータそのものを送る
        - 最初に私が出した例を使うなら「Xのポストをサーバーに送る（登録する）」ということ。
        - Xの「ポストする」は `post` で正しい。
        - `get` になるときはポストの検索結果を取得する時になる

## 総括: `POST` まで進んでいるが、一度最初に戻ってやり直したほうがいい気がする

p121まで現在は進んでいる。

だが、最初の方の基礎知識がだいぶ抜け落ちてしまっているので復習のためにもう一度戻ってやり直したほうがいい気もしている。

その頃はこうやって学習メモを残していなかったので今度は残しながらやってみよう。